import java.util.*;class T{public static void main(String[]a){(new T()).t();}void p(String k,int i){System.out.print(k+(i<1?"":"\n"));}int[][]G;int P;int c(){int m,a,b,i;for(a=b=i=0;i<3;i++){a=G[i][0];b=G[0][i];m=((a==G[i][1])&&(G[i][1]==G[i][2])&&a>0)?a:((b==G[1][i])&&(G[1][i]==G[2][i])&&b>0)?b:0;if(m>0){return m;}}m=G[1][1];return(((G[0][0]==m)&&(m==G[2][2])||(b==m)&&(m==a))?m:0);}void g(){for(int[]i:G){for(int j:i)p(w(j),0);p("",1);}p("",1);}int x(int i){return(new Random()).nextInt(i);}String w(int i){return(i<1)?".":((2*i-3)*P<0)?"X":"O";}int y(){return(new Scanner(System.in)).nextInt();}void Z(){int i,j;do{i=x(3);j=x(3);}while(!s(i,j,1));}int o(int a,int b,int c,int z,int x){return(a==b&&c==x&&a==z)?2:(a==x&&b==c&&b==z)?0:(a==c&&b==x&&c==z)?1:-1;}int q(int z,int y){int i=0,j;for(;i<3;i++){j=o(G[i][0],G[i][1],G[i][2],z,0);if(j>=0){s(i,j,y);return 1;}j=o(G[0][i],G[1][i],G[2][i],z,0);if(j>=0){s(j,i,y);return 1;}}i=o(G[0][0],G[1][1],G[2][2],z,0);if(i>=0){s(i,i,y);return 1;}i=o(G[0][2],G[1][1],G[2][0],z,0);if(i>=0){s(i,2-i,y);return 1;}return 0;}int b(int z,int y){int i=0,j;for(;i<3;i++){j=o(G[i][0],G[i][1],G[i][2],0,z);if(j>=0){s(i,2-j/2,y);return 1;}j=o(G[0][i],G[1][i],G[2][i],0,z);if(j>=0){s(2-j/2,i,y);return 1;}}i=o(G[0][0],G[1][1],G[2][2],0,z);if(i>=0){s(2-i/2,2-i/2,y);return 1;}i=o(G[0][2],G[1][1],G[2][0],0,z);if(i>=0){s(2-i/2,i/2,y);return 1;}return 0;}void z(){if(!(q(1,1)>0||q(2,1)>0||s(1,1,1)||b(1,1)>0))Z();}boolean s(int i,int j,int z){if(G[i][j]<1){p(w(z)+" to "+j+","+i,1);return(G[i][j]=z)==z;}return 0>1;}void t(){while(1>0){G=new int[3][3];int m=9,x;if(x(2)<1){P=1;Z();g();m--;}else P=-1;do{do{p("x?",0);x=y();p("y?",0);}while(!s(y(),x,2));m--;g();x=c();if(x>0||m<1)break;z();g();m--;x=c();}while(m>0&&x<1);if(x<1)p("No winner!",1);else p(w(x)+" wins!",1);}}}
